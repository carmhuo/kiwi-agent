# 构建一个企业级DataAgen项目Kiwi
## 背景与目的
目前传统的BI应用构建一般有以下几个步骤：
1. 接入数据源
2. 数据建模,构建指标与维度
3. 创建图表
4. 创建DashBoard,进行图表布局

本次主要通过DataAgent实现以下功能：
1. 创建数据源
2. 创建数据集，定义与组织数据源中的数据
2. 通过自然语言查询数据集，利用大语言模型+工具调用能力，将自然语言翻译为可执行的sql，并对sql进行校验，校验通过后数据库引擎执行并返回结果。
3. 输出查询报告，包括文字与图表，结果支持返回UI页面展示与PDF文档下载
4. 接收用户对结果的反馈信息（喜欢/不喜欢）

让业务和数据分析师能快速及时的进行数据探索并获得洞察，支持更好的做出决策

## 功能描述
本节主要描述DataAgent应用包含的主要功能。
1. 用户管理，支持用户登录与登出 
2. 项目管理，可以创建一个项目空间 
3. 数据源管理，支持在项目下创建并管理数据源
4. 数据集管理，支持在项目下使用一个或者多个数据源创建数据集
5. Agent管理，支持创建一个React Agent，类型可扩展，比如：TEXT2SQL, RETRIEVAL
6. 权限管理，用户权限管理，基于RBAC
   * 用户角色：系统管理员、项目管理员、普通用户
   * 权限控制：不同角色对资源的操作权限不同,系统管理员拥有所有权限，项目管理员拥有其管理项目的权限（包括项目内的数据源、数据集、Agent、成员等），普通用户在项目内，可以创建对话、发送消息，但不能修改项目设置。
7. 对话功能，包括交互式对话，历史对话查询

注意： 项目为核心组织单元，数据源、数据集、Agent和对话都归属特定项目

### 前端页面要求
* 登录与注册页面
* 主页面布局：主要分为3块，head + 左侧边栏 + 中间显示区； 
* head主要包括logo与平台名称， 使用手册， 用户登录信息 
* 左侧边栏为功能菜单栏，包括对话与配置， 对话和配置菜单支持下拉子菜单 ，对话菜单下拉支持历史对话查询；配置功能包括其它所有管理功能，如数据源管理、数据集管理、权限管理等。
* 中间为显示区，展示对话框或者配置管理内容
* UI界面符合现代简约设计原则


### 后端服务要求
* 设计功能的Rest API接口，符合OpenAPI规范
* 后端使用Python FastAPI + Langchain(Langgraph)构建ReAct agent + DuckDB作为数据查询引擎
* 数据存储，使用关系事务数据库，默认为Sqlite, 设计需灵活，方便后期扩展其它数据库如postgresql
* 交互式对话，消息助手查询可能需要比较长的时间，所以需设计为异步查询，先返回用户消息，再使用SSE获取助手消息，
